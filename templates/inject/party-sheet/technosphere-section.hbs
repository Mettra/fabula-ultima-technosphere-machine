<div class="tab technosphere-tab-container" data-tab="technosphere-machine">
    {{#if isGM}}
    <fieldset class="section-container title-fieldset desc resource-content">
        <legend class="resource-label-m">
            Technosphere Machine Settings (GM)
        </legend>
        <div class="header-fields grid grid-9col" style="margin: 5px 0;">
            <label for="ts-sphere-table" style="grid-column: span 2;">Roll Table UUID</label>
            <input type="text" id="ts-sphere-table" name="ts-sphere-table" value="{{rollableTable}}" style="grid-column: span 6;" data-dtype="RollTable" />
            <a class="clear-button" id="clear-ts-sphere-table" title="Clear Roll Table UUID" style="grid-column: span 1; text-align: center; cursor: pointer; line-height: inherit;">&#10006;</a>
        </div>
        <div class="header-fields grid grid-9col" style="margin: 5px 0;">
            <label for="ts-roll-cost" style="grid-column: span 2;">Roll Cost ({{localize "FU.Zenit"}})</label>
            <input type="number" id="ts-roll-cost" name="ts-roll-cost" value="{{rollCost}}" style="grid-column: span 6;" min="0" step="50" data-dtype="Number" />
            <a class="clear-button" id="clear-ts-roll-cost" title="Reset to Default (600)" style="grid-column: span 1; text-align: center; cursor: pointer; line-height: inherit;">&#8634;</a>
        </div>
    {{/if}}
    </fieldset>
    <fieldset class="section-container title-fieldset desc resource-content">
        <div class="technosphere-actions">
            <button type="button" class="button {{#if (eq activeTab "create")}}active{{/if}}" data-action="select-technosphere-tab" data-tab="create">Create</button>
            <button type="button" class="button {{#if (eq activeTab "level-up")}}active{{/if}}" data-action="select-technosphere-tab" data-tab="level-up">Level Up</button>
            <button type="button" class="button {{#if (eq activeTab "combine")}}active{{/if}}" data-action="select-technosphere-tab" data-tab="combine">Combine</button>
            <button type="button" class="button {{#if (eq activeTab "sacrifice")}}active{{/if}}" data-action="select-technosphere-tab" data-tab="sacrifice">Sacrifice</button>
        </div>
    </fieldset>

    <div class="technosphere-content">
        <div class="technosphere-tab-content" data-tab="create" {{#unless (eq activeTab "create")}}style="display: none;"{{/unless}}>
            <fieldset class="section-container title-fieldset desc resource-content" style="text-align:center;">
                <legend class="resource-label-m">Create</legend>
                <button type="button" class="technosphere-roll button button-style" style="width: 200px; height:200px;">
                    <i class="icon ra ra-dice-five"></i> Roll Mnemosphere
                </button>
            </fieldset>
            <div style="margin-top: 10px;">
            </div>
        </div>
        <div class="technosphere-tab-content" data-tab="level-up" {{#unless (eq activeTab "level-up")}}style="display: none;"{{/unless}}>
            <fieldset class="section-container title-fieldset desc resource-content">
                <legend class="resource-label-m">Level Up</legend>
                <div style="text-align: center; padding: 20px;">Coming soon!</div>
            </fieldset>

            <!--
            <fieldset class="section-container title-fieldset desc resource-content">
                <legend class="resource-label-m">Level Up</legend>
                <div class="infusion-container" style="text-align: center; padding: 10px;">
                    <div class="infusion-skill-dropzone" style="border: 2px dashed #ccc; padding: 30px; margin-bottom: 10px; background-color: rgba(0,0,0,0.1);">
                        <div class="placeholder-text">Drag a skill to infuse it into the mnemosphere</div>
                        <div class="skill-display" style="display: none; align-items: center; justify-content: center; flex-direction: column;">
                            <img src="" alt="Skill Icon" style="width: 64px; height: 64px; border: none;" />
                            <span class="skill-name" style="font-size: 1.2em; font-weight: bold;"></span>
                        </div>
                    </div>
                    <div class="infusion-sphere-socket" style="border: 2px dashed #ccc; padding: 10px; margin-bottom: 10px; width: 100px; height: 100px; margin-left: auto; margin-right: auto; display: flex; align-items: center; justify-content: center; background-image: url('modules/fabula-ultima-technosphere-machine/assets/mnemosphere-blank.png'); background-size: contain; background-repeat: no-repeat; background-position: center;">
                        <div class="socket-placeholder" style="font-size: 0.8em;">Socket for sphere</div>
                        <div class="sphere-display" style="display: none;">
                            <img src="" alt="Sphere Icon" style="width: 64px; height: 64px; border: none;" />
                        </div>
                    </div>
                    <button type="button" class="button infuse-button">Infuse</button>
                </div>
            </fieldset>
            -->
        </div>
        <div class="technosphere-tab-content" data-tab="combine" {{#unless (eq activeTab "combine")}}style="display: none;"{{/unless}}>
            <fieldset class="section-container title-fieldset desc resource-content">
                <legend class="resource-label-m">Combine</legend>
                <div style="text-align: center; padding: 20px;">Coming soon!</div>
            </fieldset>
        </div>
        <div class="technosphere-tab-content" data-tab="sacrifice" {{#unless (eq activeTab "sacrifice")}}style="display: none;"{{/unless}}>
            <fieldset class="section-container title-fieldset desc resource-content">
                <legend class="resource-label-m">Sacrifice</legend>
                <div style="text-align: center; padding: 20px;">Coming soon!</div>
            </fieldset>
        </div>
    </div>

    <fieldset class="section-container title-fieldset desc resource-content mnemosphere-inventory">
        <legend class="resource-label-m">
            Mnemospheres
        </legend>
        <div class="Mnemosphere-selection-area" style="margin: 5px 0;">
            {{#if characterMnemospheres}}
            <label class="resource-label" style="display: block; margin-bottom: 8px; font-weight: bold;">Character Inventory</label>
            <div class="Mnemosphere-grid">
                {{#each characterMnemospheres}}
                    {{> "modules/fabula-ultima-technosphere-machine/templates/inject/party-sheet/Mnemosphere-card.hbs"
                        this=this
                    }}
                {{/each}}
            </div>
            {{/if}}

            {{#if partyMnemospheres}}
            <label class="resource-label" style="display: block; margin-bottom: 8px; font-weight: bold;">Party Inventory</label>
            <div class="Mnemosphere-grid">
                {{#each partyMnemospheres}}
                    {{> "modules/fabula-ultima-technosphere-machine/templates/inject/party-sheet/Mnemosphere-card.hbs"
                        this=this
                    }}
                {{/each}}
            </div>
            {{/if}}
        </div>
    </fieldset>
</div>
